```javascript

// main.js
createApp(App).mount('#app')


// ================

function createApp(rootComponent){
	return {
		mount(rootContainer){
			// 先转换为 vnode
			// 之后所有逻辑操作 都基于 vnode 做处理
			const vnode = createVNode(rootComponent)

			render(vnode, rootContainer)
		}
	}
}

function createVNode(type, props?, children?){
	const vnode = {
		type,
		props,
		children
	}
	return vnode
}


function render(vnode, container){
	// 调用 patch 方法，（为了后边方便递归处理）
	patch(vnode, container)
}


function patch(vnode, container){
	// type of vnode

	// 处理组件
	processComponent(vnode, container)
}

function processComponent(vnode, container){
	// mount
	mountComponent(vnode, container)
	
}


function mountComponent(vnode, container){
	// 组件 有自己的一些信息，例如 插槽、props 等，这些信息需要进行存储，所以这里需要去创建一个实例对象 instance，用来方便存储
	const instance = createComponentInstance(vnode)

	setupComponent(instance)

	setupRenderEffect(instance, container)
}


function createComponentInstance(vnode){
	const component = {
		vnode,
		type: vnode.type
	}
	return component
}


function setupComponent(instance){
	// initProps

	// initSlots

	// 这里有两种，一个是有状态的，一个是函数组件（无状态），这里只处理了有状态的
	setupStatefulComponent(instance)
}


function setupStatefulComponent(instance){
	// 只需要调用 setup，拿到 setup 调用的返回值即可
	// instance.vnode.type => .setup

	const Component = instance.type // === instance.vnode.type

	const { setup } = Component

	if(setup){
		//  setupResult: function | object
		// function: render函数
		// object: 将这个 object 注入到当前组件的上下文中
		const setupResult = setup()

		handleSetupResult(instance, setupResult)
	}
}

function handleSetupResult(instance, setupResult){
	// function | object
	if(typeof setupResult == 'object'){
		// 注入到上下文中
		instance.setupState = setupResult
	}

	// 为了保证 组件的 render 有值
	finishComponentSetup(instance)
}


function finishComponentSetup(instance){
	// 判断当前组件是否有 render
	const Component = instance.type

	if(Component.render){
		instance.render = Component.render
	}
}


function setupRenderEffect(instance, container){
	const subTree = instance.render()

	// 对 render 函数返回的 vnode 进一步去执行 patch
	// 当前 vnode type 是 element -> mountElement
	patch(subTree, container)
}

```